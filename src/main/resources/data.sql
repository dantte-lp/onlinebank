-- ===================================================================
-- ONLINE BANK INITIAL DATA
-- ===================================================================
-- Этот файл создает несколько демо-клиентов для быстрого старта
-- Основная инициализация происходит через DataInitializer.java
-- ===================================================================

-- Проверяем, что таблица пустая (чтобы не дублировать данные)
DO $$
BEGIN
    IF NOT EXISTS (SELECT 1 FROM clients LIMIT 1) THEN
        -- Вставляем несколько демо-клиентов
        INSERT INTO clients (
            unique_id,
            last_name,
            first_name,
            middle_name,
            birth_date,
            account_number,
            currency,
            nationality,
            phone_number
        ) VALUES
        -- Клиенты с рублевыми счетами
        (
            '550e8400-e29b-41d4-a716-446655440001',
            'Иванов',
            'Иван',
            'Иванович',
            '1985-03-15',
            '10000000000000000001',
            'RUB',
            'RUSSIA',
            '+79001234567'
        ),
        (
            '550e8400-e29b-41d4-a716-446655440002',
            'Петрова',
            'Елена',
            'Сергеевна',
            '1990-07-22',
            '10000000000000000002',
            'RUB',
            'RUSSIA',
            '+79001234568'
        ),

        -- Клиент с долларовым счетом
        (
            '550e8400-e29b-41d4-a716-446655440003',
            'Сидоров',
            'Алексей',
            'Владимирович',
            '1978-11-10',
            '10000000000000000003',
            'USD',
            'RUSSIA',
            '+79001234569'
        ),

        -- Клиент с евро счетом
        (
            '550e8400-e29b-41d4-a716-446655440004',
            'Козлова',
            'Мария',
            'Александровна',
            '1995-01-30',
            '10000000000000000004',
            'EUR',
            'RUSSIA',
            '+79001234570'
        ),

        -- Иностранные клиенты
        (
            '550e8400-e29b-41d4-a716-446655440005',
            'Smith',
            'John',
            NULL,
            '1982-05-18',
            '10000000000000000005',
            'USD',
            'USA',
            '+12025551234'
        ),
        (
            '550e8400-e29b-41d4-a716-446655440006',
            'Müller',
            'Hans',
            NULL,
            '1988-09-25',
            '10000000000000000006',
            'EUR',
            'GERMANY',
            '+491701234567'
        ),

        -- Клиенты из СНГ
        (
            '550e8400-e29b-41d4-a716-446655440007',
            'Назарбаев',
            'Нурлан',
            'Аскарович',
            '1992-04-12',
            '10000000000000000007',
            'RUB',
            'KAZAKHSTAN',
            '+77011234567'
        ),
        (
            '550e8400-e29b-41d4-a716-446655440008',
            'Ахмедов',
            'Рустам',
            'Шухратович',
            '1987-12-05',
            '10000000000000000008',
            'USD',
            'UZBEKISTAN',
            '+998901234567'
        ),

        -- Молодые клиенты
        (
            '550e8400-e29b-41d4-a716-446655440009',
            'Новикова',
            'Анастасия',
            'Дмитриевна',
            '2000-06-15',
            '10000000000000000009',
            'RUB',
            'RUSSIA',
            '+79001234571'
        ),
        (
            '550e8400-e29b-41d4-a716-446655440010',
            'Волков',
            'Артем',
            'Игоревич',
            '2002-10-20',
            '10000000000000000010',
            'RUB',
            'RUSSIA',
            '+79001234572'
        );

        RAISE NOTICE 'Вставлено 10 демо-клиентов';
    ELSE
        RAISE NOTICE 'Таблица clients уже содержит данные, пропускаем вставку демо-данных';
    END IF;
END $$;

-- Выводим статистику после вставки
DO $$
DECLARE
    total_count INTEGER;
    rub_count INTEGER;
    usd_count INTEGER;
    eur_count INTEGER;
BEGIN
    SELECT COUNT(*) INTO total_count FROM clients;
    SELECT COUNT(*) INTO rub_count FROM clients WHERE currency = 'RUB';
    SELECT COUNT(*) INTO usd_count FROM clients WHERE currency = 'USD';
    SELECT COUNT(*) INTO eur_count FROM clients WHERE currency = 'EUR';

    RAISE NOTICE 'Статистика клиентов:';
    RAISE NOTICE '  Всего: %', total_count;
    RAISE NOTICE '  RUB счета: %', rub_count;
    RAISE NOTICE '  USD счета: %', usd_count;
    RAISE NOTICE '  EUR счета: %', eur_count;
END $$;